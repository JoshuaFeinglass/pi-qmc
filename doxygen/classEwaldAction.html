<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>pi: Path integral Quantum Monte Carlo: EwaldAction Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">pi: Path integral Quantum Monte Carlo
   &#160;<span id="projectnumber">VERSION</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">EwaldAction Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class for creating and evaluating Ewald evaluation of long-range action.  
 <a href="classEwaldAction.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for EwaldAction:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classEwaldAction.png" usemap="#EwaldAction_map" alt=""/>
  <map id="EwaldAction_map" name="EwaldAction_map">
<area href="classAction.html" title="Virtual base class for calculating the action." alt="Action" shape="rect" coords="0,0,82,24"/>
</map>
 </div></div>

<p><a href="classEwaldAction-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a039808cb04ffa7c9454024fd783cd60f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a039808cb04ffa7c9454024fd783cd60f">EwaldAction</a> (const SimulationInfo &amp;, const double <a class="el" href="classEwaldAction.html#aa1823af7eb2232b57e02fe9ef5558f4b">rcut</a>, const double <a class="el" href="classEwaldAction.html#a47f384a5f266111d7975da438d3daa82">kcut</a>, const int nreserve=1)</td></tr>
<tr class="memdesc:a039808cb04ffa7c9454024fd783cd60f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a039808cb04ffa7c9454024fd783cd60f"></a><br/></td></tr>
<tr class="memitem:a5f5e72ca2ffa7ad60521695fa4ef7757"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a5f5e72ca2ffa7ad60521695fa4ef7757">~EwaldAction</a> ()</td></tr>
<tr class="memdesc:a5f5e72ca2ffa7ad60521695fa4ef7757"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor deletes all <a class="el" href="classAction.html" title="Virtual base class for calculating the action.">Action</a> objects.  <a href="#a5f5e72ca2ffa7ad60521695fa4ef7757"></a><br/></td></tr>
<tr class="memitem:ad8fcf6076765933f1bb574ab3b9f95e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#ad8fcf6076765933f1bb574ab3b9f95e7">setup</a> ()</td></tr>
<tr class="memdesc:ad8fcf6076765933f1bb574ab3b9f95e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup the long range and short range action.  <a href="#ad8fcf6076765933f1bb574ab3b9f95e7"></a><br/></td></tr>
<tr class="memitem:aa2a1feb823fdae3d1cf57007fd22124a"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#aa2a1feb823fdae3d1cf57007fd22124a">getActionDifference</a> (const SectionSamplerInterface &amp;, int level)</td></tr>
<tr class="memdesc:aa2a1feb823fdae3d1cf57007fd22124a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the difference in action.  <a href="#aa2a1feb823fdae3d1cf57007fd22124a"></a><br/></td></tr>
<tr class="memitem:a8934322559c1bbe6b8f0fa7e579b8a26"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a8934322559c1bbe6b8f0fa7e579b8a26">getTotalAction</a> (const Paths &amp;, const int level) const </td></tr>
<tr class="memdesc:a8934322559c1bbe6b8f0fa7e579b8a26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the total action.  <a href="#a8934322559c1bbe6b8f0fa7e579b8a26"></a><br/></td></tr>
<tr class="memitem:af3e0869048c29e7b4dad56a919d9da2a"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#af3e0869048c29e7b4dad56a919d9da2a">getBeadAction</a> (const Paths &amp;, const int ipart, const int islice, double &amp;u, double &amp;utau, double &amp;ulambda, <a class="el" href="classAction.html#aab9fe1b22076f5ae2e1d6fdc85567101">Vec</a> &amp;fm, <a class="el" href="classAction.html#aab9fe1b22076f5ae2e1d6fdc85567101">Vec</a> &amp;fp) const </td></tr>
<tr class="memdesc:af3e0869048c29e7b4dad56a919d9da2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the action and derivatives at a bead.  <a href="#af3e0869048c29e7b4dad56a919d9da2a"></a><br/></td></tr>
<tr class="memitem:a7891b91d9d2cb3d6a6ec2b895dfcff5f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a7891b91d9d2cb3d6a6ec2b895dfcff5f">addAction</a> (<a class="el" href="classPairAction.html">PairAction</a> *a)</td></tr>
<tr class="memdesc:a7891b91d9d2cb3d6a6ec2b895dfcff5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add an action object.  <a href="#a7891b91d9d2cb3d6a6ec2b895dfcff5f"></a><br/></td></tr>
<tr class="memitem:aea71051df6d89bc96a3116876f48b5cf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#aea71051df6d89bc96a3116876f48b5cf">initialize</a> (const SectionChooser &amp;)</td></tr>
<tr class="memdesc:aea71051df6d89bc96a3116876f48b5cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize for a sampling section.  <a href="#aea71051df6d89bc96a3116876f48b5cf"></a><br/></td></tr>
<tr class="memitem:aa9e8c6c94c3d21e77bf8cdd1b1f64098"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#aa9e8c6c94c3d21e77bf8cdd1b1f64098">acceptLastMove</a> ()</td></tr>
<tr class="memdesc:aa9e8c6c94c3d21e77bf8cdd1b1f64098"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accept last move.  <a href="#aa9e8c6c94c3d21e77bf8cdd1b1f64098"></a><br/></td></tr>
<tr class="inherit_header pub_methods_classAction"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classAction')"><img src="closed.png" alt="-"/>&nbsp;Public Member Functions inherited from <a class="el" href="classAction.html">Action</a></td></tr>
<tr class="memitem:abcf4c6358f53a666631ace11b325a7cd inherit pub_methods_classAction"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAction.html#abcf4c6358f53a666631ace11b325a7cd">~Action</a> ()</td></tr>
<tr class="memitem:a3dc69fab35cc250dfb2c596786faa4fd inherit pub_methods_classAction"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAction.html#a3dc69fab35cc250dfb2c596786faa4fd">getActionDifference</a> (const Paths &amp;, const <a class="el" href="classAction.html#a4d221c1d096af88b8df67d99f4bec446">VArray</a> &amp;displacement, int nmoving, const <a class="el" href="classAction.html#a49aa914464920d47e066eac4b853fd7a">IArray</a> &amp;movingIndex, int iFirstSlice, int iLastSlice)</td></tr>
<tr class="memitem:a25bc02c90f76abeba144f82944602929 inherit pub_methods_classAction"><td class="memItemLeft" align="right" valign="top">virtual const <a class="el" href="classAction.html">Action</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAction.html#a25bc02c90f76abeba144f82944602929">getActionPointerByType</a> (const std::type_info &amp;type) const </td></tr>
<tr class="memdesc:a25bc02c90f76abeba144f82944602929 inherit pub_methods_classAction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns pointer to <a class="el" href="classAction.html" title="Virtual base class for calculating the action.">Action</a> of type t, otherwise returns null pointer.  <a href="#a25bc02c90f76abeba144f82944602929"></a><br/></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a067481ac24540a429abe9a1cbf506ff1"><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; <a class="el" href="classPairAction.html">PairAction</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a067481ac24540a429abe9a1cbf506ff1">SRActionContainer</a></td></tr>
<tr class="memitem:a3773d6ee68c5b71f1185b9da9e6d0198"><td class="memItemLeft" align="right" valign="top">typedef SRActionContainer::iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a3773d6ee68c5b71f1185b9da9e6d0198">SRActIter</a></td></tr>
<tr class="memitem:a02ddcb1fc683afba98fc8c696432f258"><td class="memItemLeft" align="right" valign="top">typedef <br class="typebreak"/>
SRActionContainer::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a02ddcb1fc683afba98fc8c696432f258">ConstSRActIter</a></td></tr>
<tr class="memitem:ad181d079e27a45a4acef25d1bea823e8"><td class="memItemLeft" align="right" valign="top">typedef blitz::TinyVector<br class="typebreak"/>
&lt; double, NDIM &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#ad181d079e27a45a4acef25d1bea823e8">Vec</a></td></tr>
<tr class="memitem:a1e421960af33b2383c2ebb7e8b122395"><td class="memItemLeft" align="right" valign="top">typedef blitz::TinyVector&lt; int, <br class="typebreak"/>
NDIM &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a1e421960af33b2383c2ebb7e8b122395">IVec</a></td></tr>
<tr class="memitem:ad6fd83f89d753ad52a4619fd3020348c"><td class="memItemLeft" align="right" valign="top">typedef blitz::Array&lt; int, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#ad6fd83f89d753ad52a4619fd3020348c">IArray</a></td></tr>
<tr class="memitem:a000ce16f15c3ffce3bd5a1ba36131d15"><td class="memItemLeft" align="right" valign="top">typedef blitz::Array&lt; double, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a000ce16f15c3ffce3bd5a1ba36131d15">Array1</a></td></tr>
<tr class="memitem:ac0353cfd99d648234628383d9d8be713"><td class="memItemLeft" align="right" valign="top">typedef blitz::Array&lt; <a class="el" href="classAction.html#aab9fe1b22076f5ae2e1d6fdc85567101">Vec</a>, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#ac0353cfd99d648234628383d9d8be713">VArray1</a></td></tr>
<tr class="memitem:a625b10732182a6c264bcbfe8be3bdfa1"><td class="memItemLeft" align="right" valign="top">typedef std::complex&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a625b10732182a6c264bcbfe8be3bdfa1">Complex</a></td></tr>
<tr class="memitem:aa6212d3c788a6a9b9077360fc5108d8d"><td class="memItemLeft" align="right" valign="top">typedef blitz::Array&lt; <a class="el" href="classEwaldAction.html#a625b10732182a6c264bcbfe8be3bdfa1">Complex</a>, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#aa6212d3c788a6a9b9077360fc5108d8d">CArray2</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a166f7ac8e8b10b589213e8ad1e322b9a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a166f7ac8e8b10b589213e8ad1e322b9a">calcLongRangeUtau</a> (<a class="el" href="classEwaldAction.html#ac0353cfd99d648234628383d9d8be713">VArray1</a> &amp;r) const </td></tr>
<tr class="memdesc:a166f7ac8e8b10b589213e8ad1e322b9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the long range action.  <a href="#a166f7ac8e8b10b589213e8ad1e322b9a"></a><br/></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:af2449fbb6b06d9111b7c9de59a6088e7"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classSuperCell.html">SuperCell</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#af2449fbb6b06d9111b7c9de59a6088e7">cell</a></td></tr>
<tr class="memdesc:af2449fbb6b06d9111b7c9de59a6088e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="classSuperCell.html" title="A simple rectangular supercell.">SuperCell</a>.  <a href="#af2449fbb6b06d9111b7c9de59a6088e7"></a><br/></td></tr>
<tr class="memitem:a8b341d4ad162545a81c9bcbd0540966b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEwaldAction.html#a067481ac24540a429abe9a1cbf506ff1">SRActionContainer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a8b341d4ad162545a81c9bcbd0540966b">actions</a></td></tr>
<tr class="memdesc:a8b341d4ad162545a81c9bcbd0540966b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointers to the short-range <a class="el" href="classAction.html" title="Virtual base class for calculating the action.">Action</a> objects.  <a href="#a8b341d4ad162545a81c9bcbd0540966b"></a><br/></td></tr>
<tr class="memitem:aa1823af7eb2232b57e02fe9ef5558f4b"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#aa1823af7eb2232b57e02fe9ef5558f4b">rcut</a></td></tr>
<tr class="memdesc:aa1823af7eb2232b57e02fe9ef5558f4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Real space cutoff.  <a href="#aa1823af7eb2232b57e02fe9ef5558f4b"></a><br/></td></tr>
<tr class="memitem:a47f384a5f266111d7975da438d3daa82"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a47f384a5f266111d7975da438d3daa82">kcut</a></td></tr>
<tr class="memdesc:a47f384a5f266111d7975da438d3daa82"><td class="mdescLeft">&#160;</td><td class="mdescRight">K-space cutoff.  <a href="#a47f384a5f266111d7975da438d3daa82"></a><br/></td></tr>
<tr class="memitem:a76f7c8b2d26f06ff50b4943a2e826fdb"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a76f7c8b2d26f06ff50b4943a2e826fdb">kappa</a></td></tr>
<tr class="memdesc:a76f7c8b2d26f06ff50b4943a2e826fdb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Screening parameter.  <a href="#a76f7c8b2d26f06ff50b4943a2e826fdb"></a><br/></td></tr>
<tr class="memitem:a43b496f6c1f5f2989ea6d9331a8fa4f1"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a43b496f6c1f5f2989ea6d9331a8fa4f1">tau</a></td></tr>
<tr class="memdesc:a43b496f6c1f5f2989ea6d9331a8fa4f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The timestep.  <a href="#a43b496f6c1f5f2989ea6d9331a8fa4f1"></a><br/></td></tr>
<tr class="memitem:ad8f668d865aef7445fe2c561cc9c6e93"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#ad8f668d865aef7445fe2c561cc9c6e93">npart</a></td></tr>
<tr class="memdesc:ad8f668d865aef7445fe2c561cc9c6e93"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of particles.  <a href="#ad8f668d865aef7445fe2c561cc9c6e93"></a><br/></td></tr>
<tr class="memitem:ae708f18b7933c42f2ea4a23a73cdeea2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEwaldAction.html#a000ce16f15c3ffce3bd5a1ba36131d15">Array1</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#ae708f18b7933c42f2ea4a23a73cdeea2">q</a></td></tr>
<tr class="memdesc:ae708f18b7933c42f2ea4a23a73cdeea2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The particle charges.  <a href="#ae708f18b7933c42f2ea4a23a73cdeea2"></a><br/></td></tr>
<tr class="memitem:a97ada8cd24493a54705787786b4bed03"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEwaldAction.html#ac0353cfd99d648234628383d9d8be713">VArray1</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a97ada8cd24493a54705787786b4bed03">pos</a></td></tr>
<tr class="memdesc:a97ada8cd24493a54705787786b4bed03"><td class="mdescLeft">&#160;</td><td class="mdescRight">The particle positions.  <a href="#a97ada8cd24493a54705787786b4bed03"></a><br/></td></tr>
<tr class="memitem:afaa25a48d989d77686b01950700e5d90"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#afaa25a48d989d77686b01950700e5d90">selfEnergy</a></td></tr>
<tr class="memdesc:afaa25a48d989d77686b01950700e5d90"><td class="mdescLeft">&#160;</td><td class="mdescRight">The self-energy term, <img class="formulaInl" alt="$\frac{\kappa}{\sqrt\pi}\sum_j q_j^2$" src="form_5.png"/>.  <a href="#afaa25a48d989d77686b01950700e5d90"></a><br/></td></tr>
<tr class="memitem:aa2900d06c4064ae2274134fd0315133c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEwaldAction.html#a1e421960af33b2383c2ebb7e8b122395">IVec</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#aa2900d06c4064ae2274134fd0315133c">ikmax</a></td></tr>
<tr class="memdesc:aa2900d06c4064ae2274134fd0315133c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integer limits of k-space sums.  <a href="#aa2900d06c4064ae2274134fd0315133c"></a><br/></td></tr>
<tr class="memitem:a36f4d424f618f871d072f2b0be230df7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classAction.html#aab9fe1b22076f5ae2e1d6fdc85567101">Vec</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a36f4d424f618f871d072f2b0be230df7">deltak</a></td></tr>
<tr class="memdesc:a36f4d424f618f871d072f2b0be230df7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reciprical space lattice spacing.  <a href="#a36f4d424f618f871d072f2b0be230df7"></a><br/></td></tr>
<tr class="memitem:a59b3f0c7a8505ec4ded3d8fc938e0664"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a59b3f0c7a8505ec4ded3d8fc938e0664">totk</a></td></tr>
<tr class="memdesc:a59b3f0c7a8505ec4ded3d8fc938e0664"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of k-vectors.  <a href="#a59b3f0c7a8505ec4ded3d8fc938e0664"></a><br/></td></tr>
<tr class="memitem:ad7664dda0985b75432765246b68be3db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEwaldAction.html#a000ce16f15c3ffce3bd5a1ba36131d15">Array1</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#ad7664dda0985b75432765246b68be3db">expoverk2</a></td></tr>
<tr class="memdesc:ad7664dda0985b75432765246b68be3db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stored values of <img class="formulaInl" alt="$e^{-\frac{k^2}{4\kappa^2}}/k^2$" src="form_6.png"/>.  <a href="#ad7664dda0985b75432765246b68be3db"></a><br/></td></tr>
<tr class="memitem:ac96cabcb4d0da3193ac5377e0aba9183"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEwaldAction.html#aa6212d3c788a6a9b9077360fc5108d8d">CArray2</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#ac96cabcb4d0da3193ac5377e0aba9183">eikx</a></td></tr>
<tr class="memdesc:ac96cabcb4d0da3193ac5377e0aba9183"><td class="mdescLeft">&#160;</td><td class="mdescRight">Arrays to tabulate <img class="formulaInl" alt="$e^{ik_xx},e^{ik_yy},e^{ik_zz}$" src="form_7.png"/>.  <a href="#ac96cabcb4d0da3193ac5377e0aba9183"></a><br/></td></tr>
<tr class="memitem:adc8eb797dcfa72cd9c1c9d9496a682d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEwaldAction.html#aa6212d3c788a6a9b9077360fc5108d8d">CArray2</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#adc8eb797dcfa72cd9c1c9d9496a682d0">eiky</a></td></tr>
<tr class="memitem:a5a4be7cf10f93c494f857eb6e305829c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEwaldAction.html#aa6212d3c788a6a9b9077360fc5108d8d">CArray2</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a5a4be7cf10f93c494f857eb6e305829c">eikz</a></td></tr>
<tr class="memitem:a15c17ce5d2078e715766581a501d124e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a15c17ce5d2078e715766581a501d124e">twoPiOverV</a></td></tr>
<tr class="memdesc:a15c17ce5d2078e715766581a501d124e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The the <img class="formulaInl" alt="$2\pi/V$" src="form_8.png"/> prefactor on the k-space sum.  <a href="#a15c17ce5d2078e715766581a501d124e"></a><br/></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a1192599ba9936d91890561a2c2ca84fc"><td class="memItemLeft" align="right" valign="top">static const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEwaldAction.html#a1192599ba9936d91890561a2c2ca84fc">PI</a></td></tr>
<tr class="memdesc:a1192599ba9936d91890561a2c2ca84fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constants.  <a href="#a1192599ba9936d91890561a2c2ca84fc"></a><br/></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_classAction"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classAction')"><img src="closed.png" alt="-"/>&nbsp;Public Types inherited from <a class="el" href="classAction.html">Action</a></td></tr>
<tr class="memitem:a4d221c1d096af88b8df67d99f4bec446 inherit pub_types_classAction"><td class="memItemLeft" align="right" valign="top">typedef blitz::Array&lt; <a class="el" href="classAction.html#aab9fe1b22076f5ae2e1d6fdc85567101">Vec</a>, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAction.html#a4d221c1d096af88b8df67d99f4bec446">VArray</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Class for creating and evaluating Ewald evaluation of long-range action. </p>
<p>The most common Ewald summation technique splits a sum of <img class="formulaInl" alt="$1/r$" src="form_2.png"/> potentials into short-range real space and long-range k-space terms, </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \newcommand{\bfr}{\mathbf{r}} \newcommand{\bfk}{\mathbf{k}} \sum_{i<j} \frac{q_iq_j}{|\bfr_{ij}|} =\sum_{i<j}\frac{q_iq_j\operatorname{erfc}(\kappa|\bfr_{ij}|)}{|\bfr_{ij}|} +\frac{2\pi}{V}\sum_{\bfk\ne 0}\frac{e^{-\frac{|\bfk|^2}{4\kappa^2}}}{|\bfk|^2} \left|\sum_j q_j e^{i\bfk\cdot\bfr_j}\right|^2 -\frac{\kappa}{\sqrt\pi}\sum_j q_j^2 -\frac{2\pi}{3V}\left|\sum_j q_j\bfr_j\right|^2 \]" src="form_3.png"/>
</p>
<p> Thus the following quantity is zero, </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \newcommand{\bfr}{\mathbf{r}} \newcommand{\bfk}{\mathbf{k}} 0=-\sum_{i<j}\frac{q_iq_j\operatorname{erf}(\kappa|\bfr_{ij}|)}{|\bfr_{ij}|} +\frac{2\pi}{V}\sum_{\bfk\ne 0}\frac{e^{-\frac{|\bfk|^2}{4\kappa^2}}}{|\bfk|^2} \left|\sum_j q_j e^{i\bfk\cdot\bfr_j}\right|^2 -\frac{\kappa}{\sqrt\pi}\sum_j q_j^2 -\frac{2\pi}{3V}\left|\sum_j q_j\bfr_j\right|^2, \]" src="form_4.png"/>
</p>
<p> and we add it to the input actions. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Make a new implementation using optimized Ewald breakup, as described in <a href="http://dx.doi.org/10.1006/jcph.1995.1054">Natoli and Ceperley, J. Comp. Phys. <b>117</b>, 171-178 (1995).</a> </dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000003">Bug:</a></b></dt><dd>Only works for NDIM=3. </dd></dl>
<dl class="section version"><dt>Version:</dt><dd>$Revision$ </dd></dl>
<dl class="section author"><dt>Author:</dt><dd>John Shumway. </dd></dl>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00060">60</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>
</div><hr/><h2>Member Typedef Documentation</h2>
<a class="anchor" id="a000ce16f15c3ffce3bd5a1ba36131d15"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef blitz::Array&lt;double,1&gt; <a class="el" href="classEwaldAction.html#a000ce16f15c3ffce3bd5a1ba36131d15">EwaldAction::Array1</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00067">67</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa6212d3c788a6a9b9077360fc5108d8d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef blitz::Array&lt;<a class="el" href="classEwaldAction.html#a625b10732182a6c264bcbfe8be3bdfa1">Complex</a>,2&gt; <a class="el" href="classEwaldAction.html#aa6212d3c788a6a9b9077360fc5108d8d">EwaldAction::CArray2</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00070">70</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="a625b10732182a6c264bcbfe8be3bdfa1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::complex&lt;double&gt; <a class="el" href="classEwaldAction.html#a625b10732182a6c264bcbfe8be3bdfa1">EwaldAction::Complex</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00069">69</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="a02ddcb1fc683afba98fc8c696432f258"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef SRActionContainer::const_iterator <a class="el" href="classEwaldAction.html#a02ddcb1fc683afba98fc8c696432f258">EwaldAction::ConstSRActIter</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00063">63</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad6fd83f89d753ad52a4619fd3020348c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef blitz::Array&lt;int,1&gt; <a class="el" href="classEwaldAction.html#ad6fd83f89d753ad52a4619fd3020348c">EwaldAction::IArray</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classAction.html#a49aa914464920d47e066eac4b853fd7a">Action</a>.</p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00066">66</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1e421960af33b2383c2ebb7e8b122395"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef blitz::TinyVector&lt;int,NDIM&gt; <a class="el" href="classEwaldAction.html#a1e421960af33b2383c2ebb7e8b122395">EwaldAction::IVec</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00065">65</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="a067481ac24540a429abe9a1cbf506ff1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;<a class="el" href="classPairAction.html">PairAction</a>*&gt; <a class="el" href="classEwaldAction.html#a067481ac24540a429abe9a1cbf506ff1">EwaldAction::SRActionContainer</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00061">61</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3773d6ee68c5b71f1185b9da9e6d0198"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef SRActionContainer::iterator <a class="el" href="classEwaldAction.html#a3773d6ee68c5b71f1185b9da9e6d0198">EwaldAction::SRActIter</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00062">62</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac0353cfd99d648234628383d9d8be713"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef blitz::Array&lt;<a class="el" href="classAction.html#aab9fe1b22076f5ae2e1d6fdc85567101">Vec</a>,1&gt; <a class="el" href="classEwaldAction.html#ac0353cfd99d648234628383d9d8be713">EwaldAction::VArray1</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00068">68</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad181d079e27a45a4acef25d1bea823e8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef blitz::TinyVector&lt;double,NDIM&gt; <a class="el" href="classEwaldAction.html#ad181d079e27a45a4acef25d1bea823e8">EwaldAction::Vec</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classAction.html#aab9fe1b22076f5ae2e1d6fdc85567101">Action</a>.</p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00064">64</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a039808cb04ffa7c9454024fd783cd60f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EwaldAction::EwaldAction </td>
          <td>(</td>
          <td class="paramtype">const SimulationInfo &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>rcut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>kcut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nreserve</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>

</div>
</div>
<a class="anchor" id="a5f5e72ca2ffa7ad60521695fa4ef7757"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual EwaldAction::~EwaldAction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Virtual destructor deletes all <a class="el" href="classAction.html" title="Virtual base class for calculating the action.">Action</a> objects. </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="aa9e8c6c94c3d21e77bf8cdd1b1f64098"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void EwaldAction::acceptLastMove </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Accept last move. </p>

<p>Reimplemented from <a class="el" href="classAction.html#a99cf47708531d844a80af01d66a231df">Action</a>.</p>

</div>
</div>
<a class="anchor" id="a7891b91d9d2cb3d6a6ec2b895dfcff5f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EwaldAction::addAction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPairAction.html">PairAction</a> *&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add an action object. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00088">88</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

<p>References <a class="el" href="EwaldAction_8h_source.html#l00097">actions</a>.</p>

<p>Referenced by <a class="el" href="ActionParser_8cc_source.html#l00703">ActionParser::parseEwaldActions()</a>.</p>

</div>
</div>
<a class="anchor" id="a166f7ac8e8b10b589213e8ad1e322b9a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EwaldAction::calcLongRangeUtau </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEwaldAction.html#ac0353cfd99d648234628383d9d8be713">VArray1</a> &amp;&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the long range action. </p>

</div>
</div>
<a class="anchor" id="aa2a1feb823fdae3d1cf57007fd22124a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double EwaldAction::getActionDifference </td>
          <td>(</td>
          <td class="paramtype">const SectionSamplerInterface &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>level</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the difference in action. </p>

<p>Implements <a class="el" href="classAction.html#a5e3c515d7ffeeec2b2e257e9acd19bcb">Action</a>.</p>

</div>
</div>
<a class="anchor" id="af3e0869048c29e7b4dad56a919d9da2a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void EwaldAction::getBeadAction </td>
          <td>(</td>
          <td class="paramtype">const Paths &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ipart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>islice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>utau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>ulambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAction.html#aab9fe1b22076f5ae2e1d6fdc85567101">Vec</a> &amp;&#160;</td>
          <td class="paramname"><em>fm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAction.html#aab9fe1b22076f5ae2e1d6fdc85567101">Vec</a> &amp;&#160;</td>
          <td class="paramname"><em>fp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the action and derivatives at a bead. </p>

<p>Implements <a class="el" href="classAction.html#aff88157afb9ed080c1d61f8dd4c1de0c">Action</a>.</p>

</div>
</div>
<a class="anchor" id="a8934322559c1bbe6b8f0fa7e579b8a26"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double EwaldAction::getTotalAction </td>
          <td>(</td>
          <td class="paramtype">const Paths &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>level</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the total action. </p>

<p>Implements <a class="el" href="classAction.html#a66a78abff9155f4dc973fe2461c4a4ef">Action</a>.</p>

</div>
</div>
<a class="anchor" id="aea71051df6d89bc96a3116876f48b5cf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void EwaldAction::initialize </td>
          <td>(</td>
          <td class="paramtype">const SectionChooser &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize for a sampling section. </p>

<p>Reimplemented from <a class="el" href="classAction.html#a4846f18699c79a8d6c56b3f3e6e0043f">Action</a>.</p>

</div>
</div>
<a class="anchor" id="ad8fcf6076765933f1bb574ab3b9f95e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EwaldAction::setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup the long range and short range action. </p>

<p>Referenced by <a class="el" href="ActionParser_8cc_source.html#l00703">ActionParser::parseEwaldActions()</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a8b341d4ad162545a81c9bcbd0540966b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEwaldAction.html#a067481ac24540a429abe9a1cbf506ff1">SRActionContainer</a> EwaldAction::actions</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointers to the short-range <a class="el" href="classAction.html" title="Virtual base class for calculating the action.">Action</a> objects. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00097">97</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

<p>Referenced by <a class="el" href="EwaldAction_8h_source.html#l00088">addAction()</a>.</p>

</div>
</div>
<a class="anchor" id="af2449fbb6b06d9111b7c9de59a6088e7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classSuperCell.html">SuperCell</a>&amp; EwaldAction::cell</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The <a class="el" href="classSuperCell.html" title="A simple rectangular supercell.">SuperCell</a>. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00095">95</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

<p>Referenced by <a class="el" href="JelliumSlab_8cc_source.html#l00043">JelliumSlab::getActionDifference()</a>.</p>

</div>
</div>
<a class="anchor" id="a36f4d424f618f871d072f2b0be230df7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAction.html#aab9fe1b22076f5ae2e1d6fdc85567101">Vec</a> EwaldAction::deltak</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reciprical space lattice spacing. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00119">119</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac96cabcb4d0da3193ac5377e0aba9183"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEwaldAction.html#aa6212d3c788a6a9b9077360fc5108d8d">CArray2</a> EwaldAction::eikx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Arrays to tabulate <img class="formulaInl" alt="$e^{ik_xx},e^{ik_yy},e^{ik_zz}$" src="form_7.png"/>. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00125">125</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="adc8eb797dcfa72cd9c1c9d9496a682d0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEwaldAction.html#aa6212d3c788a6a9b9077360fc5108d8d">CArray2</a> EwaldAction::eiky</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00125">125</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5a4be7cf10f93c494f857eb6e305829c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEwaldAction.html#aa6212d3c788a6a9b9077360fc5108d8d">CArray2</a> EwaldAction::eikz</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00125">125</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad7664dda0985b75432765246b68be3db"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEwaldAction.html#a000ce16f15c3ffce3bd5a1ba36131d15">Array1</a> EwaldAction::expoverk2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stored values of <img class="formulaInl" alt="$e^{-\frac{k^2}{4\kappa^2}}/k^2$" src="form_6.png"/>. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00123">123</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa2900d06c4064ae2274134fd0315133c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEwaldAction.html#a1e421960af33b2383c2ebb7e8b122395">IVec</a> EwaldAction::ikmax</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Integer limits of k-space sums. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00117">117</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="a76f7c8b2d26f06ff50b4943a2e826fdb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double EwaldAction::kappa</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Screening parameter. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00103">103</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="a47f384a5f266111d7975da438d3daa82"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double EwaldAction::kcut</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>K-space cutoff. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00101">101</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad8f668d865aef7445fe2c561cc9c6e93"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int EwaldAction::npart</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The number of particles. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00107">107</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1192599ba9936d91890561a2c2ca84fc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double EwaldAction::PI</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constants. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00115">115</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="a97ada8cd24493a54705787786b4bed03"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEwaldAction.html#ac0353cfd99d648234628383d9d8be713">VArray1</a> EwaldAction::pos</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The particle positions. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00111">111</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae708f18b7933c42f2ea4a23a73cdeea2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEwaldAction.html#a000ce16f15c3ffce3bd5a1ba36131d15">Array1</a> EwaldAction::q</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The particle charges. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00109">109</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa1823af7eb2232b57e02fe9ef5558f4b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double EwaldAction::rcut</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Real space cutoff. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00099">99</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="afaa25a48d989d77686b01950700e5d90"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EwaldAction::selfEnergy</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The self-energy term, <img class="formulaInl" alt="$\frac{\kappa}{\sqrt\pi}\sum_j q_j^2$" src="form_5.png"/>. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00113">113</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="a43b496f6c1f5f2989ea6d9331a8fa4f1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double EwaldAction::tau</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The timestep. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00105">105</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="a59b3f0c7a8505ec4ded3d8fc938e0664"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EwaldAction::totk</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of k-vectors. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00121">121</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<a class="anchor" id="a15c17ce5d2078e715766581a501d124e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EwaldAction::twoPiOverV</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The the <img class="formulaInl" alt="$2\pi/V$" src="form_8.png"/> prefactor on the k-space sum. </p>

<p>Definition at line <a class="el" href="EwaldAction_8h_source.html#l00129">129</a> of file <a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="EwaldAction_8h_source.html">EwaldAction.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Aug 10 2012 13:15:55 for pi: Path integral Quantum Monte Carlo by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.1
</small></address>
</body>
</html>
