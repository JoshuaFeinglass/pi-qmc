<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>pi-qmc: Build / Install</title>

    <link rel="stylesheet" href="../stylesheets/styles.css">
    <link rel="stylesheet" href="../stylesheets/pygment_trac.css">
    <script src="../javascripts/headfoot.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <script type="text/JavaScript"><!--
        writeHeader("../"); //-->
      </script>
      <section>
         <h1>Introduction</h1>
         <p>The easiest way to build is to use</p>
         <pre> ./configure &nbsp;
         make
         </pre>
        <p>For a parallel build</p>
        <pre>./configure --enable-mpi MPICXX=mpic++ MPICC=mpicc MPIF77=mpif77</pre>
        <p>where you should use the names of your MPI enabled compilers.</p>
        <p>You can also build for different numbers of physical dimensions (default is NDIM=3)</p>
        <pre>./configure --with-ndim=2</pre>
      </section>
      <section>
        <h1>Required Libraries</h1>
        <p>We use the following libraries in the <i>pi</i> code:</p>
            <li><a href= "http://xmlsoft.org/">libxml2</a>).</li>
            <!--HYPERLINK ON BLITZ++ DOES NOT WORK
            <li><a href= "http://xmlsoft.org/">blitz++</a>).</li> -->
            <li><a href= "http://www.hdfgroup.org/">hdf5</a>).</li>
            <li><a href= "http://xmlsoft.org/">fftw3</a>).</li>          
            <li>BLAS/LAPACK</li>
            <li><a href= "http://www.gnu.org/software/gsl/">gsl</a>).</li>
            &nbsp;
        <h1>Advanced build using multiple directories</h1>
        <p>In research, we often want different versions of the executables, for example, versions with and without MPI, or versions compiled for two-dimensional systems. To accomplish this, we make a pibuilds directory beside our svn checkout directory (pi or pi-qmc). We then make empty subdirectories for each build, for example ndim2mpi for a two dimensional MPI version. A typical directory structure is:</p>
        <pre>
          codes/
            pi-qmc/
            configure
            src/
            lib/
          pibuilds/
            ndim1/
            ndim2/
            ndim3/
            ndim1mpi/
            ndim2mpi/
            ndim3mpi/
            debug/
        </pre>
        <p>To build, go into the empty build directory,</p>
        <pre> cd ~/codes/pibuilds/ndim2mpi</pre>
        <p>Then run the configure script with the desired options</p>
        <pre> ../../configure --with-ndim=2 --enable-mpi</pre>
        <p>You will probably want more configure options; see the platform specific instructions below for some examples.
            Then, make the code in that directory,</p>
        <pre> make -j2</pre>
        <p>For conveniance, you can make a soft link to the executable</p>
        <pre> ln -sf ~/codes/pibuilds/ndim3mpi ~/bin/pi2Dmpi</pre>
      </section>
      <section>
        <h1>Platform Specific Instructions</h1>
        <h2>Mac OS X</h2>
        <p>All the dependencies are available through
        <a href="http://www.macports.org/">macports.</a> It is also handy to install the latest gcc compilers (with gfortran), openmpi, and python utilities for data analysis and plotting.</p>
      <pre>$ port installed
              libxml2 @2.7.3_0 (active)
              blitz @0.9_0 (active)
              hdf5-18 @1.8.3_0 (active)
              gsl @1.12_0 (active)
              fftw-3 @3.2.2_0 (active)

              gcc44 @4.4.0_0 (active)

              python26 @2.6.2_3 (active)
              py26-numpy @1.3.0_0 (active)
              py26-ipython @0.9.1_0+scientific (active)
              py26-scipy @0.7.0_0+gcc44 (active)
              py26-tables @2.1_0 (active)</pre>
      <p>The following configure works well on an intel mac</p>
      <pre> ../../pi/configure CXX=g++-mp-4.4 CC=gcc-mp-4.4 \
 CXXFLAGS="-O3 -g -Wall -ffast-math -ftree-vectorize \
 -march=native -fomit-frame-pointer -pipe" \ 
 F77=gfortran-mp-4.4</pre>
      <p>or, for an MPI enabled build,</p>
      <pre> ../../pi/configure --enable-mpi CXX=g++-mp-4.4 CC=gcc-mp-4.4 F77=gfortran-mp-4.4 \
 MPICC=openmpicc MPICXX=openmpicxx MPIF77=openmpif77 \
 CXXFLAGS="-O3 -g -Wall -ffast-math -ftree-vectorize \
 -march=native -fomit-frame-pointer -pipe"</pre>
      <p>On a G5 mac, try:</p>
      <pre> ../../pi/configure --with-ndim=3  F77=gfortran-mp-4.4 CC=gcc-mp-4.4 CXX=g++-mp-4.4\
 CXXFLAGS="-g -O3 -ffast-math -ftree-vectorize -maltivec -mpowerpc-gpopt \
 -mpowerpc64 falign-functions=32 -falign-labels=32 -falign-loops=32 -falign-jumps=32 -funroll-loops"</pre>
      <p>or, for an MPI enabled build,</p>
      <pre> ../../pi/configure --with-ndim=3 --enable-mpi \
 CXXFLAGS="-g -O3 -ffast-math -ftree-vectorize -maltivec -mpowerpc-gpopt \
 -mpowerpc64 falign-functions=32 -falign-labels=32 -falign-loops=32 -falign-jumps=32 -funroll-loops" \
  F77=gfortran-mp-4.4 CC=gcc-mp-4.4 CXX=g++-mp-4.4  MPICC=openmpicc MPICXX=openmpicxx MPIF77=openmpif77</pre>
      <p>To run piworld you will also need pyqt4</p>
      <pre> sudo port install py26-pyqt4</pre>
      <h2>Ubuntu</h2>
      </section>
      <script type="text/JavaScript"><!--
        writeFooter("../"); //-->
      </script>
    </div>
    <script src="javascripts/scale.fix.js"></script>
  </body>
</html>
